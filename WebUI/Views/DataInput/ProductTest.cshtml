@section Style{
    @Styles.Render("~/Content/bootstrap-datepicker")
    @Styles.Render("~/Content/bootstrap-switch")

}

@section Header{
    <style>
        .cascading-dropdown-loading {
            cursor: wait;
            background: url('/img/ajax-loader.gif') 85% center no-repeat transparent;
        }

        .center {
            width: auto;
            display: table;
            margin-left: auto;
            margin-right: auto;
        }

        .no-border-left {
            border-left: 0px !important;
        }

        .no-border-right {
            border-right: 0px !important;
        }

        .text-center {
            text-align: center;
        }

        td {
            text-align: center;
            padding: 2px !important;
            border: 1px solid !important;
        }

        .no-border {
            border: 0px !important;
        }

        .header-table td {
            border: 0px !important;
        }

        .large-input {
            height: 77px;
        }

        input {
            font-size: 10px !important;
        }

        #product input {
            outline: none !important;
            border-left: 0px !important;
            border-top: 0px !important;
            border-right: 0px !important;
            border-bottom: 1px !important;
        }
    </style>
}

<body>
    <div class="col-sm-12" id="qt_picture">
        <div class="ibox float-e-margins">
            <div class="ibox-title">

                <div class="row">

                    <div class="col-sm-12">
                      
                        <div class="ibox-content">
                            <div class="row center" style="margin-top:30px;display:inline" id="product">
                                <div>
                                    <table class="header-table" style="width:100%">
                                        <tr>
                                            <td colspan="1" style="width:50%;padding-left:20%!important"><span style="font-size:30px">广东中德电缆有限公司</span></td>
                                        </tr>

                                        <tr>
                                            <td colspan="1" style="padding-left:20%!important"><span style="font-size:20px;">成品检验记录表</span></td>
                                            @*<td colspan="1" style="width:10%"><span style="float:right">录入时间</span></td>
                                            <td colspan="2">
                                                <div class="input-group date" style="z-index:9999">
                                                    <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                                                    <input name="InputDate" type="text" class="form-control">
                                                </div>
                                            </td>*@
                                            <td colspan="1" style="width:10%"><span style="float:right">表单编号</span></td>
                                            <td colspan="1" sty><input name="Code" class="form-control" /></td>
                                        </tr>
                                    </table>
                                </div>
                                <table id="pd_table" align="center" class="table table-bordered center-block">
                                    <tr>
                                        <td rowspan="3">成品盘号</td>
                                        <td rowspan="3">型号规格</td>
                                        <td rowspan="3">数量(m)</td>
                                        <td rowspan="3">检验数据</td>
                                        <td rowspan="3">导体结构</td>
                                        <td colspan="4" rowspan="1">线材垂直外径 （mm）</td>
                                        <td colspan="4" rowspan="1">绝缘规格尺寸 （mm）</td>
                                        <td colspan="4" rowspan="1">护套 （mm）</td>
                                        <td rowspan="3">20°C导体<br />直流电阻Ω/km</td>
                                        <td rowspan="3">耐压测试KV/min</td>
                                        <td rowspan="3">外观</td>
                                        <td rowspan="3">检验结论</td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" rowspan="2">盘头</td>
                                        <td colspan="2" rowspan="2">盘尾</td>
                                        <td colspan="2" rowspan="1">平均厚度</td>
                                        <td colspan="2" rowspan="1">最薄点</td>
                                        <td colspan="2" rowspan="1">平均厚度</td>
                                        <td colspan="2" rowspan="1">最薄点</td>
                                    </tr>
                                    <tr>
                                        <td colspan="1" rowspan="1">盘头</td>
                                        <td colspan="1" rowspan="1">盘尾</td>
                                        <td colspan="1" rowspan="1">盘头</td>
                                        <td colspan="1" rowspan="1">盘尾</td>
                                        <td colspan="1" rowspan="1">盘头</td>
                                        <td colspan="1" rowspan="1">盘尾</td>
                                        <td colspan="1" rowspan="1">盘头</td>
                                        <td colspan="1" rowspan="1">盘尾</td>
                                    </tr>
                                    <tr>
                                        <td rowspan="2" style="width:4%"><textarea name="VolNum" class="form-control large-input" rows="3" cols="3"></textarea></td>
                                        <td rowspan="2" style="width:4%"><textarea name="SpecNum" class="form-control large-input" rows="3" cols="3"></textarea></td>
                                        <td rowspan="2" style="width:4%"><textarea name="Num" class="form-control large-input" rows="3" cols="3"></textarea></td>
                                        <td rowspan="1" colspan="1">标准</td>
                                        <td colspan="1"><input name="Std_ConductorStruct" class="form-control" /></td>
                                        <td colspan="4"><input name="Std_VerticalDia" class="form-control" /></td>
                                        <td colspan="2"><input name="Std_EdgeDiaAvg" class="form-control" /></td>
                                        <td colspan="2"><input name="Std_EdgeDiaMin" class="form-control" /></td>
                                        <td colspan="2"><input name="Std_SheathAvg" class="form-control" /></td>
                                        <td colspan="2"><input name="Std_SheathMin" class="form-control" /></td>
                                        <td colspan="1"><input name="Std_Resistance" class="form-control" /></td>
                                        <td colspan="1"><input name="Std_VoltageTest" class="form-control" /></td>
                                        <td colspan="1" rowspan="2" style="width:4%"><textarea name="Appearance" class="form-control large-input" rows="3" cols="5"></textarea></td>
                                        <td colspan="1" rowspan="2" style="width:4%"><textarea name="CheckResult" class="form-control large-input" rows="3" cols="5"></textarea></td>

                                    </tr>
                                    <tr>
                                        <td colspan="1">实测</td>
                                        <td colspan="1"><input name="Actual_ConductorStruct" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_VerticalDiaHeader1" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_VerticalDiaHeader2" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_VerticalDiaFooter1" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_VerticalDiaFooter2" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_EdgeDiaAvgHeader" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_EdgeDiaAvgFooter" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_EdgeDiaMinHeader" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_EdgeDiaMinFooter" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_SheathAvgHeader" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_SheathAvgFooter" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_SheathMinHeader" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_SheathMinFooter" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_Resistance" class="form-control" /></td>
                                        <td colspan="1"><input name="Actual_VoltageTest" class="form-control" /></td>
                                    </tr>


                                </table>
                               
                          


                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

@section Footer{
    @Scripts.Render("~/Scripts/bootstrap-switch")
    @Scripts.Render("~/Scripts/cascadingdropdown")
    @Scripts.Render("~/Scripts/bootstrap-datepicker")




    <script>
        $(function (mcAdmin) {

            var $product = $("#product");
            //控制编辑状态
            (function () {
                endableEdit(true);
               

            }())

        

            $('.input-group.date').datepicker({
                todayBtn: "linked",
                keyboardNavigation: false,
                forceParse: false,
                calendarWeeks: true,
                autoclose: true
            });

            (function () {
                $.post("/DataInput/SearchProductByVolNumAction", { volNum: "A1501" }, function (retData) {
                    mcAdmin.dealRetData(retData, function () {
                        console.log(retData);
                        deserailzeTable("product", retData.Appendix);
                        $product.css("display", "inline");

                    })
                })
            }())
           
            //检索结果
            $("#ps_search_btn").on("click", function () {
                var volNum = $("#ps_volnum_input").val();
                if (volNum + "" == "") {
                    swal({
                        title: "错误！",
                        text: "请输入盘号",
                        type: "error",
                    }, function () {

                    })
                    return;
                }
                $.post("/DataInput/SearchProductByVolNumAction", { volNum: volNum }, function (retData) {
                    mcAdmin.dealRetData(retData, function () {
                        console.log(retData);
                        deserailzeTable("product", retData.Appendix);
                        $product.css("display", "inline");

                    })
                })
            })
            //保存修改
            $("#ps_save_btn").on("click", function () {
                var product = $("#product").serializeForm();
                console.log("保存的product: " + product);
                $.post("/DataInput/SaveReportProductAction", { product: product }, function (retData) {
                    mcAdmin.dealRetData(retData, function () {
                        swal({
                            title: "恭喜！",
                            text: retData.Content,
                            type: "success",
                        }, function () {

                        })
                    }
                    );
                })
            })
            function deserailzeTable(table, data) {
                if (table.indexOf("#") == -1) {
                    table = "#" + table;
                }
                $(table).find("input,textarea").each(function (i, v) {
                    var value = data[$(v).attr("name")];
                    if ($(v).attr("name") == "InputDate") {

                        var re = /-?\d+/;
                        var m = re.exec(value);
                        var d = new Date(parseInt(m[0]));
                        $(v).val(d.getFullYear() + '-' + (d.getMonth() + 1) + "-" + d.getDate())
                        return;
                    }

                    if ($(v).attr("type") == "radio") {
                        return;
                    }

                    $(v).val(value);
                });
            }

            function endableEdit(state) {
                $product.find("input,textarea").map(function () {
                    $(this).attr("disabled", !state)
                })
            }

        }(window.parent.mcAdmin))
    </script>
}
